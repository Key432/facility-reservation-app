# Next.jsにおけるレンダリングの種類

Next.js App RouterはSSRやISRといったサイト構築の機能を提供しています。これらを理解することで、パフォーマンスやレスポンスの改善や、セキュリティの強化を行えます。

## レンダリングの種類

### SSG

SSR（サーバーサイドジェネレーティング）とは、ユーザからのリクエストに対し、サーバ上でレンダリングを行い、ユーザにHTMLとしてレスポンスを返すレンダリング方法です。レンダリングはビルド時に一度行われ、静的なファイルとして作成されます。

SSRの登場の背景としてSEOへの対応があります。「03.Reactの基礎」の「Reactの仕組み」に記載したように、従来のReactのサイトはただ一つの`<div>`タグをHTMLファイルとして返し、サイトの構成はJS上で行います。そのため、JavaScriptの挙動を検知しないSEOではコンテンツが認識されず、検索優先度が下がることがありました（最近は改善されているようですが）。
また、レンダリングの処理が重たい場合、サイトが描画されるまで真っ白なサイトが表示されることになります。これはUXを低下させます。
そのため、サーバ上でReactをレンダリングし、HTMLファイルとして返すようにすることで、SEOに対応するためにSSRは登場しました。他にも、サーバのDBと近いところでレンダリングを行えるため、データのセキュリティやアクセス性能を担保できます。

### CSR

CSR（クライアントサイドレンダリング）とは、従来のクライアント上でJSからDOMを形成しレンダリングする方法です。ただし、Next.jsにおいては、CSRとSSRの選択はコンポーネント単位で行われます。そのため、ユーザーの操作に応じてレスポンスを行うパーツは分割し、その部分だけをCSRとすることができます。

### ISR／SSR

ISR（インクリメンタルサーバサイドレンダリング）とは、ビルド時にレンダリングを行い結果をキャッシュするSSRに対して、定期的に内容を更新するSSRです。情報が時々更新されるようなコンテンツに向いています。しかし、ある程度の時間結果がキャッシュされるため、常に最新の結果が表示されるとは限りません。

SSR（サーバサイドレンダリング）はアクセスがあったときにサーバサイドで都度レンダリングを行う（結果をキャッシュしない）レンダリング方法です。

これらを`use client`をファイル上部に書くなどの方法でNext.jsでは選択することになります。
それぞれの特長を理解して、コンポーネントを役割ごとに分割し、適切なレンダリング方法を検討する必要があります。

## 参考

[Next.js Web アプリケーションにおける SSG とSSR の比較： 正しいレンダリングアプローチの選択](https://aws.amazon.com/jp/blogs/news/ssg-vs-ssr-in-next-js-web-applications-choosing-the-right-rendering-approach/)
[Server-side Rendering (SSR)](https://nextjs.org/docs/pages/building-your-application/rendering/server-side-rendering)
[Next.jsでSSGとSSRとかISRとか調べてみた](https://zenn.dev/kisukeyas/articles/bf13fd8f722add)
